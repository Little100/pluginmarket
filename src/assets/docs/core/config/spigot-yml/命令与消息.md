# spigot.yml 配置详解 - 命令与消息

本文档介绍 spigot.yml 中 `commands` 和 `messages` 节点的配置选项，用于自定义服务器命令行为和消息文本。

## commands 部分

`commands` 节点包含与命令相关的配置选项。

```yaml
commands:
  replace-commands:
    - setblock
    - summon
    - testforblock
    - tellraw
  spam-exclusions:
    - /skill
  silent-commandblock-console: false
  log: true
  tab-complete: 0
  send-namespaced: true
```

---

## replace-commands

| 属性 | 值 |
|------|-----|
| 键名 | `commands.replace-commands` |
| 类型 | 字符串列表 |
| 默认值 | `[setblock, summon, testforblock, tellraw]` |

指定哪些原版命令应该被 Bukkit 版本替换。

这些命令的 Bukkit 实现可能与原版有细微差异，但通常提供更好的兼容性或性能。

### 默认替换的命令

- `setblock`：放置方块
- `summon`：召唤实体
- `testforblock`：测试方块（已弃用）
- `tellraw`：发送 JSON 格式消息

### 自定义示例

如果某个插件需要原版命令行为，可以从列表中移除：

```yaml
commands:
  replace-commands:
    - setblock
    - summon
    # 移除 tellraw 以使用原版实现
```

---

## spam-exclusions

| 属性 | 值 |
|------|-----|
| 键名 | `commands.spam-exclusions` |
| 类型 | 字符串列表 |
| 默认值 | `[/skill]` |

指定哪些命令不受垃圾信息过滤器限制。

Spigot 有内置的命令垃圾信息过滤器，防止玩家快速重复执行命令。某些需要频繁执行的命令（如技能命令）可以添加到此列表中排除。

### 使用场景

- RPG 插件的技能命令
- 需要快速连续执行的命令
- 自动化脚本使用的命令

### 配置示例

```yaml
commands:
  spam-exclusions:
    - /skill
    - /cast
    - /ability
    - /menu
```

---

## silent-commandblock-console

| 属性 | 值 |
|------|-----|
| 键名 | `commands.silent-commandblock-console` |
| 类型 | 布尔值 |
| 默认值 | `false` |

控制命令方块执行的命令是否在控制台显示。

- `true`：命令方块执行的命令不会在控制台输出
- `false`：命令方块执行的命令会在控制台显示

### 使用场景

如果你的服务器有大量命令方块，启用此选项可以减少控制台日志的噪音。但这也会使调试命令方块问题变得困难。

---

## log

| 属性 | 值 |
|------|-----|
| 键名 | `commands.log` |
| 类型 | 布尔值 |
| 默认值 | `true` |

控制是否记录玩家执行的命令。

- `true`：在控制台记录玩家执行的命令
- `false`：不记录玩家命令

### 安全建议

建议保持 `true`，以便：
- 追踪玩家行为
- 调查滥用问题
- 审计管理员操作

---

## tab-complete

| 属性 | 值 |
|------|-----|
| 键名 | `commands.tab-complete` |
| 类型 | 整数 |
| 默认值 | `0` |

控制命令 Tab 补全的行为。

- `0`：允许所有命令的 Tab 补全
- `-1`：禁用所有命令的 Tab 补全
- `> 0`：只有输入指定字符数后才显示补全建议

### 使用场景

| 值 | 效果 |
|----|------|
| 0 | 完整的 Tab 补全体验 |
| -1 | 隐藏服务器命令列表（安全考虑） |
| 3 | 输入 3 个字符后才显示补全 |

### 安全提示

设置为 `-1` 可以防止玩家通过 Tab 补全发现服务器安装的插件，但会影响用户体验。

---

## send-namespaced

| 属性 | 值 |
|------|-----|
| 键名 | `commands.send-namespaced` |
| 类型 | 布尔值 |
| 默认值 | `true` |

控制是否向客户端发送带命名空间的命令。

- `true`：发送带命名空间的命令（如 `minecraft:give`）
- `false`：只发送简短命令名

### 影响

禁用此选项可以减少 Tab 补全列表中的命令数量，但某些功能可能需要命名空间命令。

---

## messages 部分

`messages` 节点允许自定义服务器发送给玩家的各种消息。

```yaml
messages:
  whitelist: You are not whitelisted on this server!
  unknown-command: Unknown command. Type "/help" for help.
  server-full: The server is full!
  outdated-client: Outdated client! Please use {0}
  outdated-server: Outdated server! I'm still on {0}
  restart: Server is restarting
```

---

## messages.whitelist

| 属性 | 值 |
|------|-----|
| 键名 | `messages.whitelist` |
| 类型 | 字符串 |
| 默认值 | `You are not whitelisted on this server!` |

当未在白名单中的玩家尝试加入时显示的消息。

### 自定义示例

```yaml
messages:
  whitelist: "抱歉，你不在服务器白名单中。请联系管理员申请加入。"
```

### 支持颜色代码

可以使用 `§` 或 `&` 颜色代码：

```yaml
messages:
  whitelist: "&c你不在白名单中！&e请联系管理员。"
```

---

## messages.unknown-command

| 属性 | 值 |
|------|-----|
| 键名 | `messages.unknown-command` |
| 类型 | 字符串 |
| 默认值 | `Unknown command. Type "/help" for help.` |

当玩家输入未知命令时显示的消息。

### 自定义示例

```yaml
messages:
  unknown-command: "未知命令。输入 /help 查看帮助。"
```

### 安全提示

自定义此消息可以避免泄露服务器信息。例如，不要显示"命令不存在"，而是显示统一的错误消息。

---

## messages.server-full

| 属性 | 值 |
|------|-----|
| 键名 | `messages.server-full` |
| 类型 | 字符串 |
| 默认值 | `The server is full!` |

当服务器已满时显示给尝试加入的玩家的消息。

### 自定义示例

```yaml
messages:
  server-full: "服务器已满！请稍后再试，或购买 VIP 获得优先进入权限。"
```

---

## messages.outdated-client

| 属性 | 值 |
|------|-----|
| 键名 | `messages.outdated-client` |
| 类型 | 字符串 |
| 默认值 | `Outdated client! Please use {0}` |

当玩家客户端版本过低时显示的消息。

### 占位符

- `{0}`：服务器支持的版本号

### 自定义示例

```yaml
messages:
  outdated-client: "你的客户端版本过低！请更新到 {0} 版本。"
```

---

## messages.outdated-server

| 属性 | 值 |
|------|-----|
| 键名 | `messages.outdated-server` |
| 类型 | 字符串 |
| 默认值 | `Outdated server! I'm still on {0}` |

当玩家客户端版本过高时显示的消息。

### 占位符

- `{0}`：服务器当前版本号

### 自定义示例

```yaml
messages:
  outdated-server: "服务器版本较低，当前为 {0}。请使用对应版本的客户端。"
```

---

## messages.restart

| 属性 | 值 |
|------|-----|
| 键名 | `messages.restart` |
| 类型 | 字符串 |
| 默认值 | `Server is restarting` |

服务器重启时踢出玩家显示的消息。

### 自定义示例

```yaml
messages:
  restart: "服务器正在重启，请稍后重新连接。"
```

---

## 消息自定义最佳实践

### 1. 使用中文

为中文玩家提供友好的中文消息：

```yaml
messages:
  whitelist: "你不在服务器白名单中，请联系管理员。"
  unknown-command: "未知命令，输入 /help 查看帮助。"
  server-full: "服务器已满，请稍后再试。"
  outdated-client: "客户端版本过低，请更新到 {0}。"
  outdated-server: "客户端版本过高，服务器版本为 {0}。"
  restart: "服务器重启中，请稍后重连。"
```

### 2. 添加颜色

使用颜色代码增强可读性：

```yaml
messages:
  whitelist: "&c&l白名单限制 &7| &f你不在服务器白名单中"
  unknown-command: "&c未知命令 &7| &f输入 &e/help &f查看帮助"
  server-full: "&c服务器已满 &7| &f请稍后再试"
```

### 3. 包含联系方式

在消息中包含有用的信息：

```yaml
messages:
  whitelist: "你不在白名单中。申请地址：example.com/apply"
  server-full: "服务器已满。VIP 玩家可优先进入，详情：example.com/vip"
```

---

## 相关文档

- [基础设置](基础设置.md) - 全局配置选项
- [概述](概述.md) - spigot.yml 文件概述
