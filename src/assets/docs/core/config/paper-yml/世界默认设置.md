# Paper 世界默认设置

本文档介绍 `paper-world-defaults.yml` 中的世界级配置项。这些配置可以为每个世界单独设置。

## 配置文件位置

- **全局默认**：`config/paper-world-defaults.yml`
- **单独世界**：`<世界目录>/paper-world.yml`（如 `world/paper-world.yml`）

单独世界的配置会覆盖全局默认配置。

---

## command-blocks（命令方块）

命令方块相关配置。

```yaml
command-blocks:
  force-follow-perm-level: true
  permissions-level: 2
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `force-follow-perm-level` | `true` | 强制命令方块遵循权限等级 |
| `permissions-level` | `2` | 命令方块的权限等级（0-4） |

---

## environment（环境）

世界环境相关配置。

```yaml
environment:
  disable-explosion-knockback: false
  disable-ice-and-snow: false
  disable-teleportation-suffocation-check: false
  disable-thunder: false
  fire-tick-delay: 30
  frosted-ice:
    delay:
      max: 40
      min: 20
    enabled: true
  generate-flat-bedrock: false
  nether-ceiling-void-damage-height: disabled
  optimize-explosions: false
  portal-create-radius: 16
  portal-search-radius: 128
  portal-search-vanilla-dimension-scaling: true
  treasure-maps:
    enabled: true
    find-already-discovered:
      loot-tables: default
      villager-trade: false
  water-over-lava-flow-speed: 5
```

### 常用配置说明

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `disable-explosion-knockback` | `false` | 禁用爆炸击退 |
| `disable-ice-and-snow` | `false` | 禁用冰雪生成 |
| `disable-thunder` | `false` | 禁用雷暴天气 |
| `fire-tick-delay` | `30` | 火焰蔓延延迟（tick） |
| `generate-flat-bedrock` | `false` | 生成平坦基岩层 |
| `optimize-explosions` | `false` | 优化爆炸计算 |
| `portal-create-radius` | `16` | 传送门创建搜索半径 |
| `portal-search-radius` | `128` | 传送门搜索半径 |

### 推荐的优化配置

```yaml
environment:
  optimize-explosions: true
  fire-tick-delay: 60
```

---

## fixes（修复）

各种游戏机制的修复。

```yaml
fixes:
  disable-unloaded-chunk-enderpearl-exploit: true
  falling-block-height-nerf: disabled
  fix-curing-zombie-villager-discount-exploit: true
  fix-items-merging-through-walls: false
  prevent-tnt-from-moving-in-water: false
  split-overstacked-loot: true
  tnt-entity-height-nerf: disabled
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `disable-unloaded-chunk-enderpearl-exploit` | `true` | 禁用末影珍珠卡区块漏洞 |
| `fix-curing-zombie-villager-discount-exploit` | `true` | 修复僵尸村民治愈折扣漏洞 |
| `fix-items-merging-through-walls` | `false` | 修复物品穿墙合并 |
| `prevent-tnt-from-moving-in-water` | `false` | 阻止 TNT 在水中移动 |
| `split-overstacked-loot` | `true` | 拆分超量堆叠的战利品 |

---

## hopper（漏斗）

漏斗相关配置，对服务器性能影响较大。

```yaml
hopper:
  cooldown-when-full: true
  disable-move-event: false
  ignore-occluding-blocks: false
  move-item-speed: 8
  pull-item-speed: 8
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `cooldown-when-full` | `true` | 漏斗满时启用冷却，减少检测频率 |
| `disable-move-event` | `false` | 禁用物品移动事件（可能破坏某些插件） |
| `ignore-occluding-blocks` | `false` | 忽略遮挡方块 |
| `move-item-speed` | `8` | 物品移动速度（tick） |
| `pull-item-speed` | `8` | 物品拉取速度（tick） |

### 漏斗优化建议

```yaml
hopper:
  cooldown-when-full: true
  disable-move-event: false  # 除非确定不需要，否则不要禁用
```

:::warning 注意
`disable-move-event: true` 会禁用 `InventoryMoveItemEvent`，可能导致保护插件、日志插件等无法正常工作。
:::

---

## lootables（战利品）

战利品容器相关配置。

```yaml
lootables:
  auto-replenish: false
  max-refills: -1
  refresh-max: 2d
  refresh-min: 12h
  reset-seed-on-fill: true
  restrict-player-reloot: true
  restrict-player-reloot-time: disabled
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `auto-replenish` | `false` | 自动补充战利品 |
| `max-refills` | `-1` | 最大补充次数，`-1` 为无限 |
| `refresh-max` | `2d` | 最大刷新间隔 |
| `refresh-min` | `12h` | 最小刷新间隔 |
| `restrict-player-reloot` | `true` | 限制玩家重复获取战利品 |

---

## maps（地图）

地图物品相关配置。

```yaml
maps:
  item-frame-cursor-limit: 128
  item-frame-cursor-update-interval: 10
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `item-frame-cursor-limit` | `128` | 地图上显示的物品展示框光标上限 |
| `item-frame-cursor-update-interval` | `10` | 光标更新间隔（tick） |

---

## max-growth-height（最大生长高度）

植物最大生长高度配置。

```yaml
max-growth-height:
  bamboo:
    max: 16
    min: 11
  cactus: 3
  reeds: 3
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `bamboo.max` | `16` | 竹子最大高度 |
| `bamboo.min` | `11` | 竹子最小高度 |
| `cactus` | `3` | 仙人掌最大高度 |
| `reeds` | `3` | 甘蔗最大高度 |

---

## misc（杂项）

其他杂项配置。

```yaml
misc:
  disable-end-credits: false
  disable-relative-projectile-velocity: false
  disable-sprint-interruption-on-attack: false
  light-queue-size: 20
  max-leash-distance: 10.0
  redstone-implementation: VANILLA
  shield-blocking-delay: 5
  show-sign-click-command-failure-msgs-to-player: false
  update-pathfinding-on-block-update: true
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `disable-end-credits` | `false` | 禁用末地字幕 |
| `light-queue-size` | `20` | 光照更新队列大小 |
| `max-leash-distance` | `10.0` | 最大拴绳距离 |
| `redstone-implementation` | `VANILLA` | 红石实现方式 |
| `shield-blocking-delay` | `5` | 盾牌格挡延迟（tick） |

### 红石实现方式

| 值 | 说明 |
|----|------|
| `VANILLA` | 原版红石行为 |
| `EIGENCRAFT` | 优化的红石实现，可能改变某些行为 |
| `ALTERNATE_CURRENT` | 另一种优化实现 |

:::tip 性能提示
如果服务器有大量红石机器，可以尝试 `ALTERNATE_CURRENT`，但需要测试是否影响现有红石装置。
:::

---

## scoreboards（计分板）

世界级计分板配置。

```yaml
scoreboards:
  allow-non-player-entities-on-scoreboards: true
  use-vanilla-world-scoreboard-name-coloring: false
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `allow-non-player-entities-on-scoreboards` | `true` | 允许非玩家实体加入计分板 |
| `use-vanilla-world-scoreboard-name-coloring` | `false` | 使用原版世界计分板名称着色 |

---

## spawn（生成）

生成点相关配置。

```yaml
spawn:
  allow-using-signs-inside-spawn-protection: false
  keep-spawn-loaded: true
  keep-spawn-loaded-range: 10
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `allow-using-signs-inside-spawn-protection` | `false` | 允许在出生点保护区内使用告示牌 |
| `keep-spawn-loaded` | `true` | 保持出生点区块加载 |
| `keep-spawn-loaded-range` | `10` | 保持加载的范围（区块） |

### 优化建议

如果服务器不需要保持出生点加载（如大厅服），可以禁用：

```yaml
spawn:
  keep-spawn-loaded: false
```

---

## tick-rates（Tick 速率）

各种游戏机制的 tick 速率配置。

```yaml
tick-rates:
  behavior:
    villager:
      validatenearbypoi: -1
  container-update: 1
  grass-spread: 1
  mob-spawner: 1
  sensor:
    villager:
      secondarypoisensor: 40
```

| 配置项 | 默认值 | 说明 |
|--------|--------|------|
| `container-update` | `1` | 容器更新间隔 |
| `grass-spread` | `1` | 草方块蔓延间隔 |
| `mob-spawner` | `1` | 刷怪笼 tick 间隔 |

### 村民 tick 优化

```yaml
tick-rates:
  behavior:
    villager:
      validatenearbypoi: 60
  sensor:
    villager:
      secondarypoisensor: 80
```

增加这些值可以减少村民的 AI 计算频率，提升性能。

---

## 完整优化配置示例

以下是一个综合的世界优化配置：

```yaml
environment:
  optimize-explosions: true
  fire-tick-delay: 60

hopper:
  cooldown-when-full: true

misc:
  redstone-implementation: VANILLA
  update-pathfinding-on-block-update: false

spawn:
  keep-spawn-loaded: true
  keep-spawn-loaded-range: 8

tick-rates:
  behavior:
    villager:
      validatenearbypoi: 60
  grass-spread: 4
  mob-spawner: 2
  sensor:
    villager:
      secondarypoisensor: 80
```

:::tip 提示
修改配置后需要重启服务器才能生效。建议每次只修改少量配置，观察效果后再继续调整。
:::
